
import { ExamDefinition } from './types';

export const PHASE_3_EXAM_2: ExamDefinition = {
    id: 'sap-c02-exam-2',
    title: 'AWS Solutions Architect Professional - Exam 2 (Real Practice)',
    code: 'SAP-C02',
    description: 'Professional-level difficulty. Advanced scenarios covering SAP on AWS, Mainframe Modernization, IoT at Scale, and Complex Windows Migrations.',
    timeLimitMinutes: 75,
    passingScore: 750,
    totalQuestions: 20,
    questions: [
        {
            id: 'q1',
            scenario: 'Ransomware defense. AWS Backup used. Backups must NOT be deletable by any user (including Root) for 7 years. Modifications prohibited.',
            options: ['S3 Object Lock Governance + SCP.', 'S3 Object Lock Compliance.', 'Backup Vault Lock Governance.', 'Backup Vault Lock Compliance.'],
            correctAnswer: 3,
            explanation: 'Backup Vault Lock in Compliance Mode prevents deletion by ANYONE (including Root) after the cooling-off period.',
            distractorExplanation: 'Object Lock is for S3 objects, not centralized AWS Backups. Governance mode can be bypassed by specific permissions.',
        },
        {
            id: 'q2',
            scenario: 'SAP HANA High Availability on AWS. Two AZs. Need to manage "Overlay IP" (Virtual IP) failover. No DNS TTL dependency. Most resilient?',
            options: ['Secondary Private IP + CLI Script.', 'Transit Gateway (TGW) with specific route.', 'Global Accelerator.', 'ALB.'],
            correctAnswer: 1,
            explanation: 'TGW is the standard pattern for Overlay IPs in Multi-AZ SAP. It handles the routing update outside the VPC CIDR constraints.',
            distractorExplanation: 'Secondary IPs cannot span subnets (AZs). ALB doesn\'t support all SAP protocols.',
        },
        {
            id: 'q3',
            scenario: 'Migrating legacy .NET app + 50,000 users in on-prem AD to AWS. Use "Shared Services" VPC with AWS Managed Microsoft AD. Allow AWS workloads to authenticate against on-prem users. Minimize overhead.',
            options: ['AD Connector.', 'Two-way Forest Trust.', 'Directory Service Data Replication.', 'RODC on EC2.'],
            correctAnswer: 1,
            explanation: 'Forest Trust allows AWS Managed AD to trust the on-prem AD, enabling auth without replicating 50k users or using a proxy bottleneck.',
            distractorExplanation: 'AD Connector is a proxy, not a full directory, and can be a bottleneck. RODC requires OS management.',
        },
        {
            id: 'q4',
            scenario: '450 VPCs. "Any-to-Any" connectivity. Centralized inspection VPC. Scaling 10 VPCs/month.',
            options: ['VPC Peering Mesh.', 'Peering to Security Hub.', 'Transit Gateway (TGW) + TGW Peering.', 'PrivateLink.'],
            correctAnswer: 2,
            explanation: 'TGW is the only solution that scales to hundreds/thousands of VPCs with centralized routing/inspection.',
            distractorExplanation: 'VPC Peering mesh limit is low (125) and complexity is N^2.',
        },
        {
            id: 'q5',
            scenario: 'Mainframe Modernization. COBOL core banking on IBM z/OS. "Middle Ground" approach (Replatform) to x86. Minimal code changes.',
            options: ['Refactor (Blu Age).', 'Replatform (Micro Focus).', 'Lambda with COBOL runtime.', 'App2Container.'],
            correctAnswer: 1,
            explanation: 'Replatforming (Micro Focus) runs legacy binaries/code in an emulation layer, requiring minimal changes compared to Refactoring.',
            distractorExplanation: 'Refactor converts to Java (Major change). Lambda doesn\'t support Mainframe middleware (CICS/JCL) natively.',
        },
        {
            id: 'q6',
            scenario: 'IoT Smart City. 2 million sensors. 500k msg/sec. Real-time anomaly detection -> S3. Cost-effective and scalable.',
            options: ['IoT Rules -> Kinesis Data Streams -> KDA -> S3.', 'IoT Core -> MSK -> Spark.', 'IoT Core -> S3 -> Lambda.', 'IoT Core -> Firehose -> Lambda.'],
            correctAnswer: 0,
            explanation: 'Kinesis Data Streams handles the scale. Kinesis Data Analytics (KDA) does real-time SQL/Flink anomaly detection.',
            distractorExplanation: 'MSK is more expensive/complex management. Firehose is for delivery, not real-time analytics (buffer delay).',
        },
        {
            id: 'q7',
            scenario: 'Role Explosion (2000 roles). Want single "Developer" role that grants access based on "Project" tag match.',
            options: ['RBAC (More groups).', 'ABAC (PrincipalTag conditions).', 'SCP filtering.', 'Permissions Boundaries.'],
            correctAnswer: 1,
            explanation: 'ABAC (Attribute Based Access Control) allows permissions based on matching tags (PrincipalTag:Project == ResourceTag:Project).',
            distractorExplanation: 'RBAC causes the explosion. SCPs are guardrails.',
        },
        {
            id: 'q8',
            scenario: 'FinOps. Identify specific department responsible for "Data Transfer Out" spike. Need Resource ID granularity.',
            options: ['VPC Flow Logs.', 'CUR (Cost & Usage Report) + Athena.', 'Budgets.', 'Trusted Advisor.'],
            correctAnswer: 1,
            explanation: 'CUR provides line-item granularity including Resource IDs. Athena allows SQL analysis.',
            distractorExplanation: 'Budgets/Cost Explorer often lack per-resource ID granularity for Data Transfer.',
        },
        {
            id: 'q9',
            scenario: 'Control Tower. Ensure new accounts have guardrails. Block deletion of logging config automatically. Least manual effort.',
            options: ['StackSets.', 'Control Tower Account Factory + Guardrails (SCPs).', 'Lambda + Organizations API.', 'SSM.'],
            correctAnswer: 1,
            explanation: 'Control Tower automates account factory and applies Mandatory Guardrails (SCPs) to prevent deletion of logging.',
            distractorExplanation: 'StackSets are manual/custom to build compared to CT.',
        },
        {
            id: 'q10',
            scenario: 'Legal Hold on S3 objects. Files must not be deleted until case settled. Date unknown.',
            options: ['Object Lock Compliance 100 years.', 'Object Lock Governance.', 'S3 Object Lock Legal Hold.', 'Versioning MFA.'],
            correctAnswer: 2,
            explanation: 'Legal Hold is indefinite (no expiration date) until explicitly removed.',
            distractorExplanation: 'Retention periods require a fixed date.',
        },
        {
            id: 'q11',
            scenario: 'SAP Migration. App Server <-> HANA DB latency must be sub-millisecond.',
            options: ['Spread Placement Group.', 'Partition Placement Group.', 'Cluster Placement Group.', 'Multi-AZ.'],
            correctAnswer: 2,
            explanation: 'Cluster Placement Groups pack instances into a single rack/AZ for lowest network latency.',
            distractorExplanation: 'Spread/Partition separate instances (higher latency).',
        },
        {
            id: 'q12',
            scenario: 'WorkSpaces. Join on-prem Domain. Avoid managing AD in cloud.',
            options: ['Managed Microsoft AD.', 'AD Connector.', 'Simple AD.', 'Identity Center.'],
            correctAnswer: 1,
            explanation: 'AD Connector proxies the join request to on-prem AD without a cloud AD controller.',
            distractorExplanation: 'Managed AD creates a new domain/trust.',
        },
        {
            id: 'q13',
            scenario: 'Financial Trading. Ticker plant using IP Multicast.',
            options: ['ALB Fan-out.', 'Transit Gateway Multicast.', 'SNS.', 'GRE Tunnels.'],
            correctAnswer: 1,
            explanation: 'Transit Gateway is the only service supporting IP Multicast.',
            distractorExplanation: 'ALB/VPC are Unicast.',
        },
        {
            id: 'q14',
            scenario: 'Migrate 50 TB VSAM files (Mainframe) to AWS native DB for Replatforming.',
            options: ['Aurora PostgreSQL.', 'DynamoDB.', 'RDS SQL Server.', 'MSK.'],
            correctAnswer: 0,
            explanation: 'Replatforming tools maps VSAM indexed files to Relational tables (Postgres/Oracle).',
            distractorExplanation: 'DynamoDB (NoSQL) requires refactoring code logic.',
        },
        {
            id: 'q15',
            scenario: 'Remote mining site. Intermittent internet. Run ML inference on-site.',
            options: ['IoT Core.', 'IoT Greengrass.', 'Snowball Edge.', 'SiteWise.'],
            correctAnswer: 1,
            explanation: 'Greengrass runs Lambda/Containers/ML locally on edge devices.',
            distractorExplanation: 'Snowball is for transport. Core is cloud-only.',
        },
        {
            id: 'q16',
            scenario: 'Delegate Role Creation to Project Leads. Prevent them from creating Admin roles or accessing Security Bucket.',
            options: ['SCP.', 'IAM Permissions Boundary.', 'IAM Group Deny.', 'Resource Policy.'],
            correctAnswer: 1,
            explanation: 'Permissions Boundaries restrict the defined maximum permissions a created role can have.',
            distractorExplanation: 'SCP applies to account/OU, not specifically to the act of "Creating a role" with specific permissions.',
        },
        {
            id: 'q17',
            scenario: 'Predictable c5.large 24/7 + Fluctuating Lambda/Fargate. Max flexibility.',
            options: ['EC2 Instance Savings Plans.', 'Compute Savings Plans.', 'RIs.', 'Spot.'],
            correctAnswer: 1,
            explanation: 'Compute SPs cover EC2, Fargate, and Lambda.',
            distractorExplanation: 'Instance SPs don\'t cover Lambda.',
        },
        {
            id: 'q18',
            scenario: 'Trigger action after Control Tower Account Factory creates account.',
            options: ['Poll API.', 'EventBridge `CreateManagedAccount` Lifecycle Event.', 'CloudWatch Alarm.', 'Manual.'],
            correctAnswer: 1,
            explanation: 'Control Tower publishes Lifecycle Events to EventBridge.',
            distractorExplanation: 'Polling is bad.',
        },
        {
            id: 'q19',
            scenario: 'DR Strategy. Minimize cost. Data replicated. App servers OFF until disaster.',
            options: ['Active-Active.', 'Warm Standby.', 'Pilot Light.', 'Backup Restore.'],
            correctAnswer: 2,
            explanation: 'Pilot Light = Data Hot, Compute Cold (Off).',
            distractorExplanation: 'Warm Standby = Compute Warm (Scaled down but running).',
        },
        {
            id: 'q20',
            scenario: 'Private API on internal ALBs. Global Branch offices need consistent performance accessing it over internet.',
            options: ['Global Accelerator.', 'CloudFront.', 'Direct Connect.', 'Geoproximity.'],
            correctAnswer: 0,
            explanation: 'Global Accelerator optimizes non-HTTP (or private HTTP) paths over AWS backbone.',
            distractorExplanation: 'Direct Connect is too expensive for every branch.',
        }
    ]
};
