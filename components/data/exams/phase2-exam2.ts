
import { ExamDefinition } from './types';

export const PHASE_2_EXAM_2: ExamDefinition = {
    id: 'saa-c03-exam-2',
    title: 'AWS Solutions Architect Associate - Exam 2 (Real Practice)',
    code: 'SAA-C03',
    description: 'High-difficulty scenario-based questions focusing on Containers, Advanced Networking, Data Streaming, and Governance. Sourced from high-quality practice sets.',
    timeLimitMinutes: 45,
    passingScore: 720,
    totalQuestions: 20,
    questions: [
        {
            id: 'q1',
            scenario: 'A fintech company is migrating its microservices architecture to AWS. They strictly require zero infrastructure management for the underlying servers and each container must have its own isolation boundary. Which solution should they choose?',
            options: ['AWS ECS with Amazon EC2 launch type.', 'AWS EKS with Managed Node Groups.', 'AWS ECS with AWS Fargate.', 'AWS EKS Anywhere.'],
            correctAnswer: 2,
            explanation: 'AWS Fargate is a serverless compute engine for containers that provides workload isolation by design (each task runs in its own kernel-isolated environment) and removes server management.',
            distractorExplanation: 'EC2 launch types require server management. EKS Anywhere is for on-prem.',
        },
        {
            id: 'q2',
            scenario: 'Two VPCs (A and B) need to share a specific internal application service. They have overlapping CIDR blocks (10.0.0.0/16). Standard VPC peering is not possible. What allows secure access?',
            options: ['AWS Transit Gateway.', 'AWS PrivateLink.', 'AWS Client VPN.', 'Inter-region VPC Peering.'],
            correctAnswer: 1,
            explanation: 'AWS PrivateLink allows you to share services across VPCs even if they have overlapping IP ranges via Interface Endpoints.',
            distractorExplanation: 'Transit Gateway and Peering require unique non-overlapping CIDRs.',
        },
        {
            id: 'q3',
            scenario: 'Process continuous stream of social media data in real-time with Lambda analysis, AND archive raw data to S3 within 60 seconds. Best architecture?',
            options: ['Kinesis Data Firehose -> Lambda -> S3.', 'Kinesis Data Streams (Lambda) + Kinesis Data Firehose (S3).', 'SNS -> SQS.', 'MSK.'],
            correctAnswer: 1,
            explanation: 'Kinesis Data Streams (KDS) supports sub-second real-time processing (Lambda). Kinesis Data Firehose (KDF) handles the "delivery to S3" part with buffering (min 60s).',
            distractorExplanation: 'Firehose cannot do "Real-time" sub-second processing, it buffers.',
        },
        {
            id: 'q4',
            scenario: 'Streaming service serving premium video content via CloudFront. Users get access for 24 hours. Minimal overhead for generating credentials for multiple files (HLS segments).',
            options: ['CloudFront Signed URLs.', 'CloudFront Signed Cookies.', 'S3 Presigned URLs.', 'Field-Level Encryption.'],
            correctAnswer: 1,
            explanation: 'Signed Cookies are designed for access to multiple files (a folder/wildcard) without changing the URL structure.',
            distractorExplanation: 'Signed URLs are for single files. S3 Presigned URLs bypass CloudFront caching.',
        },
        {
            id: 'q5',
            scenario: 'Route traffic based on user location (NY vs London) for compliance. Failover NY to London if NY is down.',
            options: ['Geolocation Routing with a default record.', 'Geoproximity Routing.', 'Latency Routing.', 'Multivalue Answer.'],
            correctAnswer: 0,
            explanation: 'Geolocation routing maps IP to Location for compliance. A default record handles failover/unmapped IPs.',
            distractorExplanation: 'Geoproximity is for traffic biasing (bias value). Latency is purely performance.',
        },
        {
            id: 'q6',
            scenario: 'Financial institution must store records for 7 years. Files must NOT be deleted even by root. Compliance requirement.',
            options: ['S3 Versioning.', 'S3 Object Lock in Governance mode.', 'S3 Object Lock in Compliance mode.', 'S3 Glacier Vault Lock.'],
            correctAnswer: 2,
            explanation: 'Compliance Mode explicitly prevents deletion by ANYONE, including Root, until the retention period expires.',
            distractorExplanation: 'Governance Mode allows users with specific IAM permissions to bypass the lock.',
        },
        {
            id: 'q7',
            scenario: 'Database on EC2 needs 15,000 IOPS and high throughput. Data size 500 GB. Most cost-effective EBS?',
            options: ['gp2.', 'gp3.', 'io2.', 'st1.'],
            correctAnswer: 1,
            explanation: 'gp3 allows independent IOPS provisioning. You get 3000 free, and pay for 12000. It is much cheaper than io2 (Provisioned IOPS).',
            distractorExplanation: 'gp2 IOPS is tied to size (3 IOPS/GB), so 500GB = 1500 IOPS (Too low). st1 is HDD.',
        },
        {
            id: 'q8',
            scenario: 'Ensure NO developer in ANY account can disable CloudTrail or delete the audit bucket. What is the central control?',
            options: ['IAM Policies.', 'Service Control Policies (SCP).', 'AWS Config.', 'RAM.'],
            correctAnswer: 1,
            explanation: 'SCPs (Org Policies) act as a guardrail that overrides even local Root/Admin permissions.',
            distractorExplanation: 'Config detects but doesn\'t prevent (unless auto-remediate, but SCP is the preventative guardrail).',
        },
        {
            id: 'q9',
            scenario: 'Gaming company under Layer 7 DDoS attack (HTTP POST floods). Which service specifically blocks these HTTP attacks?',
            options: ['AWS Shield Advanced.', 'AWS WAF.', 'GuardDuty.', 'Network Firewall.'],
            correctAnswer: 1,
            explanation: 'WAF allows blocking based on HTTP attributes (URI, Rate Limit, Headers).',
            distractorExplanation: 'Shield is Volumetric (L3/L4). Shield Advanced gives support, but WAF is the tool doing the L7 blocking.',
        },
        {
            id: 'q10',
            scenario: 'Legacy app writes files to local SMB share. Need to move to S3. App requires low latency access to recent files.',
            options: ['S3 File Gateway.', 'Volume Gateway (Stored).', 'Volume Gateway (Cached).', 'Tape Gateway.'],
            correctAnswer: 0,
            explanation: 'S3 File Gateway provides SMB/NFS interface backed by S3 with local caching.',
            distractorExplanation: 'Volume Gateways are iSCSI (Block), not SMB (File).',
        },
        {
            id: 'q11',
            scenario: 'Custom logic to redirect users based on `Accept-Language` header. Logic is complex (Node.js) and needs edge execution.',
            options: ['CloudFront Functions.', 'Lambda@Edge.', 'API Gateway.', 'EC2 at Edge.'],
            correctAnswer: 1,
            explanation: 'Lambda@Edge supports full Node.js/Python and higher limits than CloudFront Functions (which are JS only, very short execution).',
            distractorExplanation: 'CloudFront Functions are for simple header manipulation, but "complex logic" implies Lambda@Edge.',
        },
        {
            id: 'q12',
            scenario: 'RPO 1 second, RTO 1 minute. Aurora Database. Cross-region.',
            options: ['Aurora Multi-Master.', 'Aurora Global Database.', 'RDS Cross-Region Read Replicas.', 'DMS.'],
            correctAnswer: 1,
            explanation: 'Aurora Global Database offers < 1 second replication latency and < 1 minute failover.',
            distractorExplanation: 'RDS Replicas have higher lag and slower promotion time.',
        },
        {
            id: 'q13',
            scenario: 'Decouple "Order" component from "Shipment", "Billing", "Analytics". Fan-out pattern.',
            options: ['SNS topic fan-out to 3 SQS queues.', 'Single SQS queue for all.', 'EventBridge to S3.', 'Step Functions.'],
            correctAnswer: 0,
            explanation: 'Standard Fan-Out pattern: Publisher -> SNS -> Multiple SQS Queues.',
            distractorExplanation: 'Single Queue = Competing consumers (only one service gets the message).',
        },
        {
            id: 'q14',
            scenario: '50 VPCs. Any-to-any connectivity. Highly scalable.',
            options: ['VPC Peering mesh.', 'AWS Transit Gateway.', 'VPN Mesh.', 'VPC Endpoints.'],
            correctAnswer: 1,
            explanation: 'Transit Gateway is the hub-and-spoke scaler.',
            distractorExplanation: 'Peering mesh is N squared complexity.',
        },
        {
            id: 'q15',
            scenario: 'Automatically remediate unencrypted EBS volumes or public S3 buckets when created.',
            options: ['GuardDuty.', 'AWS Config.', 'CloudTrail.', 'Inspector.'],
            correctAnswer: 1,
            explanation: 'AWS Config Rules can trigger Systems Manager remediations.',
            distractorExplanation: 'GuardDuty finds threats. Config finds misconfigurations.',
        },
        {
            id: 'q16',
            scenario: 'Access 3rd party API key. Rotate every 30 days. Complex custom rotation script.',
            options: ['Parameter Store.', 'AWS Secrets Manager.', 'KMS.', 'S3.'],
            correctAnswer: 1,
            explanation: 'Secrets Manager has native Lambda integration for custom rotation.',
            distractorExplanation: 'Parameter Store does not natively invoke Lambda for rotation (requires EventBridge glue).',
        },
        {
            id: 'q17',
            scenario: 'Replicate S3 objects to another region ONLY if they have tag `Project: Delta`.',
            options: ['S3 CRR with filters.', 'S3 SRR.', 'DataSync.', 'Batch Operations.'],
            correctAnswer: 0,
            explanation: 'CRR supports replication rules based on prefix/tags.',
            distractorExplanation: 'Batch is for one-time.',
        },
        {
            id: 'q18',
            scenario: 'HPC financial modeling. Millions of IOPS. Temporary "Scratch" data.',
            options: ['FSx for Windows.', 'FSx for Lustre (Scratch).', 'EFS Max I/O.', 'S3 TA.'],
            correctAnswer: 1,
            explanation: 'Lustre "Scratch" is high speed, non-replicated, cheap.',
            distractorExplanation: 'Windows is too slow. EFS Max I/O has higher latency.',
        },
        {
            id: 'q19',
            scenario: 'Backup for 10 Gbps Direct Connect. Encrypted. Cost-effective.',
            options: ['Second Direct Connect.', 'Site-to-Site VPN.', 'Snowball.', 'Transit Gateway.'],
            correctAnswer: 1,
            explanation: 'VPN over internet is the standard cheap backup.',
            distractorExplanation: 'Second DX is expensive.',
        },
        {
            id: 'q20',
            scenario: 'Query 10 PB data in S3 using SQL. Infrequent access. Pay per scan.',
            options: ['Redshift.', 'Athena.', 'EMR.', 'Kinesis.'],
            correctAnswer: 1,
            explanation: 'Athena is serverless SQL on S3.',
            distractorExplanation: 'Redshift Spectrum is an option but requires a cluster.',
        }
    ]
};
